# 🚗 AI-Based Self-Driving Car using NEAT and Pygame  

## 📌 Project Overview  
This project simulates a self-driving car using **NEAT (NeuroEvolution of Augmenting Topologies)** and **Pygame**. The AI-controlled cars learn to navigate a randomly generated road by optimizing their neural networks through genetic evolution.  

The main goal of this project is to train an AI agent to drive a car along a dynamically generated road by making real-time decisions. The AI uses a neural network to control acceleration, braking, and steering, while NEAT optimizes the neural networks over generations.  

---

## 🛠️ Installation  

Ensure you have **Python 3.8+** installed. Then, install the required dependencies:  

```bash
pip install pygame neat-python numpy scipy
```

---

## 🎯 How It Works  

### 1️⃣ **Core Idea**  
The AI-controlled cars start with random behaviors, but through multiple generations, they evolve to improve their driving skills.  

Each car is controlled by a **neural network**, which takes sensor inputs and outputs control commands (steering, acceleration, etc.). The NEAT algorithm optimizes these neural networks over time based on a fitness function.  

---

### 2️⃣ **Understanding NEAT (NeuroEvolution of Augmenting Topologies)**  
NEAT is a genetic algorithm used to evolve neural networks. Instead of using backpropagation, it modifies neural networks using:  

- **Mutation**: Adding or removing neurons and connections.  
- **Crossover**: Combining the neural networks of the best-performing cars.  
- **Selection**: Keeping only the best networks for the next generation.  

This allows AI-controlled cars to learn progressively better driving strategies.  

---

### 3️⃣ **Workflow of the Project**  

1. **Initialize the AI-controlled cars**: Each car starts with a randomly generated neural network.  
2. **Generate a road**: The track is randomly created, making learning more challenging.  
3. **Simulate driving**:  
   - Each car takes sensor inputs (e.g., distance to road edges).  
   - The neural network decides acceleration, braking, and turning.  
   - Cars move forward based on the neural network’s decisions.  
4. **Check for collisions**: If a car crashes or moves too far off track, it is removed.  
5. **Assign fitness scores**:  
   - The distance traveled and speed determine the fitness score.  
   - Higher scores mean better performance.  
6. **Evolve the best networks** using NEAT:  
   - The best networks are kept.  
   - New networks are generated by mutation and crossover.  
   - The process repeats for the next generation.  

Over multiple generations, the AI improves its driving skills.  

---

## 📁 Project Structure  

```
📂 AI-Car-NEAT
│── 📝 README.md             # Project documentation
│── 🏎️ car.py               # Defines the car's movement and collision detection
│── 🛣️ road.py              # Handles road generation and drawing
│── 🌍 world.py             # Manages the game environment (screen coordinates, scoring, etc.)
│── 🧠 NNdraw.py            # Visualizes neural networks
│── ⚙️ config_variables.py  # Stores configurable settings (road width, spacing, etc.)
│── 🧬 main.py              # Main script running NEAT and Pygame simulation
│── 📜 config_file.txt      # NEAT configuration file
└── 📦 requirements.txt     # List of dependencies
```

---

## 📝 Key Components  

### 1️⃣ **Car Class (`car.py`)**  
This class represents the car and handles:  
- Movement  
- Collision detection  
- Taking sensor inputs  

### 2️⃣ **Road Class (`road.py`)**  
Handles road generation using control points and cubic splines to create smooth curves. It also calculates road borders.  

### 3️⃣ **World Class (`world.py`)**  
- Manages the game environment  
- Tracks the best-performing car  
- Updates scores  

### 4️⃣ **Neural Network Visualization (`NNdraw.py`)**  
This file helps visualize the neural network structure for debugging and understanding how the AI makes decisions.  

### 5️⃣ **NEAT Configuration (`config_file.txt`)**  
Defines neural network parameters, mutation rates, and population size for the NEAT algorithm.  

---

## 🖥️ Running the Project  

To run the project, execute:  

```bash
python main.py
```

This will start the simulation, and you will see AI cars learning to drive on the generated track.  

---

## 🔍 How Cars Take Decisions  

Each AI-controlled car takes **sensor inputs** and passes them to the **neural network**.  

### **Inputs to the Neural Network**  
- Distance to left road border  
- Distance to right road border  
- Distance to front obstacle  
- Speed of the car  

### **Outputs from the Neural Network**  
- Steering angle  
- Acceleration  
- Braking  

Each generation, the NEAT algorithm **optimizes the neural networks**, improving their ability to navigate the road.  

---

## 📊 Scoring System (Fitness Function)  

A car’s performance is measured by:  
✅ Distance traveled **(primary factor)**  
✅ Speed maintained **(higher speed = higher score)**  
❌ Collisions **(penalty for crashing)**  
❌ Moving in the wrong direction **(negative fitness score)**  

Only the best-performing cars are selected for the next generation.  

---

## 🚀 Future Improvements  

Here are some potential enhancements:  

- **Obstacle Avoidance**: Adding traffic or dynamic obstacles.  
- **Complex Road Generation**: Hills, intersections, and off-road areas.  
- **Realistic Physics**: Introducing friction, weight, and braking distances.  
- **Deep Learning Integration**: Using CNNs for better decision-making.  

---

## 🎯 Conclusion  

This project demonstrates how **NeuroEvolution** can be used for training AI in self-driving tasks. Over time, the AI improves its driving skills through **natural selection**, similar to how biological evolution works.  

🚀 Happy Coding! Let me know if you have any questions!  

